## Границы MVP

Данный воркспейс включает компоненты, которые необходимы для реализации **MVP** платформы. Этот первый релиз системы
должен представлять собой самостоятельную, полностью функциональную в рамках своего Use Case систему

UC: автоматизация процесса предоставления услуги на выдачу и аннулирование охотничьих билетов единого федерального
образца

### Функциональные требования

#### Интеграции

- Заявления
    - Получение заявлений (выдача, аннулирование, отмена выдачи) **из** СМЭВ
    - Передача изменений в статусе **в** СМЭВ и API для этого
    - Ответ с решением **в** СМЭВ
- Справочники
    - API справочников Поставщика (мастер-данных системы)
    - Актуализации внешних справочников (референсных данных системы)
- Сервисы проверки персональных данных заявителя
- ЭП обмена
- ЕСИА

#### Бизнес-процессы

- Выдача охотничьего билета
    - основной процесс
    - отмена заявления о выдаче
- Аннулирование охотничьего билета
- Внесение изменений в справочники (**MDM**)
- Управление доступом в систему (Пользователи / роли)

#### Пользовательский интерфейс

- Базовые операции с данными в табличной форме (реестры, списки, перечни)
- Работа с назначенными задачами (заполнение форм, принятие решений)
- Просмотр истории изменений объекта данных (документ, запись реестра и т.п.)
- Просмотр состояния (этапа) бизнес-процесса в форме BPMN-схемы

### Допущения в архитектуре MVP-версии

Модель компонентов Системы, представленная в данном воркспейсе, спроектирована исходя из компромисса между тем, чтобы сразу включать в ландшафт все необходимые в целевом решении элементы или, создавать MVP с минимально продуктивным кодом.

Рассмотрим модель с точки зрения тех аспектов, которыми пришлось пока пожертвовать

![](embed:huntBackend)

#### Оркестрирование микросервисов

Camunda BPM, как ядро всей системы, крайне желательно сразу внедрять в ландшафт в приближенном к продуктивному
состоянию (как функционально, так и технически). Движок запускается как Spring Boot приложение, регистрируется в
Discovery, доступна через шлюзы API Gateway. При желании, ни что не мешает даже ее помасштабировать в кластерах.

На вторую очередь отставлено следующее

- WEB-интерфейс (моделлер, работа за задачами, админка) – в рамках MVP устроит решение от самого вендора
- Система принятия решений – требует исследования применимости
- Управление формами ввода – в явном виде, требования MVP выполняются встроенными формами

#### Логирование

Организовывать систему логирования нужно с самого начала разработки. По той же причине, что и писать тесты сразу – потом к прежнему коду никто не вернется. Поэтому здесь сохранено продуктовое состояние:

> **Logback -> Filebeat -> Logstash -> Elastic -> Kibana**

В части изощренности линий сборки логов, конечно в первое время
конечно ([см. краткую инструкцию](https://structurizr.kbinform.ru/workspace/2/documentation/Hunt/Filebeat))

#### Обнаружение сервисов и распределенная конфигурация

Функции [Consul](https://structurizr.kbinform.ru/workspace/2/documentation/Hunt/Consul) будучи необходимыми разумеется внедряются, но ансамбль вспомогательных компонент в первой версии можем поубавить. В условиях без нагрузки, регистрацию можно доверить самому Консулу, повременив с внешним регистратором. По схожей логике конфиги сервисов будут до поры до времени хранится непосредственно в K/V Consul, а не коммититься в Git-репозиторий.

#### Frontend

Как уже говорилось про Camunda, тех функций,которые есть в вендорских веб-приложениях, достаточно для большинства задач настройки и администрирования компонент. Предпочтительно дать больше времени на проектирование продуктивного современного UI

#### Оркестрирование API и безопасность

Две категории объединены, поскольку, даже в целевом продуктивном решении, степень участия REST API в системном
взаимодействии при принятом подходе окажется невелика. Поскольку значительная часть операций проходит под контролем
Camunda, открывать разнообразные эндпоинты сервисами не только ни к чему, но и опасно.

> [!NOTE]
> На диаграммах можно заметить тонкие оранжевые стрелки от API Gateway к микросервисам – им соответвтуют, что
> контроллеры приложений могут выполнять только безопасные операции, за остальные отвечает BPM

Это не только позволит сейчас не погружаться слишком глубоко в реактивное программирования (при разработке Gateway), но
и дать время на обеспечение безопасности, отказоустойчивости и гармоничной балансировке нагрузки.

Реализация функций предобработки запросов безопасности в шлюзах, до передачи их в собственно IAM, показал себя как очень
надежный подход.

